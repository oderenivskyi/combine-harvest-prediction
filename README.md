# Прогнозування продуктивності комбайнів

## Опис проєкту

Цей проєкт присвячений розробці ML-рішення для прогнозування погодинної продуктивності зернозбиральних комбайнів у гектарах. Точне прогнозування дозволяє бізнесу оптимізувати логістику, планувати строки завершення жнив та мінімізувати простої техніки. Зараз це лише початковий етап проєкту та перші отримані результати, які будемо аналізувати та намагатися покращувати.

## Бізнес-задача та мета

**Проблема:**
Планування жнив часто базується на інтуїції. Непередбачувана швидкість роботи техніки через погодні умови та різношерстий парк машин призводить до:
* Простою вантажівок (або їх нестачі) в полі.
* Зриву строків збору врожаю.
* Неефективного використання елеваторних потужностей.

**Мета:**
Розробити модель машинного навчання, яка на основі історичних даних та прогнозу погоди передбачає кількість зібраних гектарів за годину для кожного комбайна.

## Дані

У проєкті використовуються історичні дані (інформація про виконані роботи + метеодані).

* **Джерело:** Внутрішня база даних та зовнішні погодні дані ресурсу https://open-meteo.com отримані через API.
* **Розмір вибірки:** ~94 тис. записів (історичні дані за попередні сезони жнив).
* **Основні ознаки:**
    * `Опади_мм`, `Сума_опадів_за_ніч_мм` — вплив опадів на швидкість жнив.
    * `Модель` - модель комбайна (наприклад, New Holland, CLAAS).
    * `Дата та час` - дата та час роботи.
* **Цільова змінна:** `Зібрано_га` — фактична продуктивність (га/год).

## Підхід та інструменти

### Етапи розробки
1.  **EDA (Exploratory Data Analysis):** Здійснено аналіз залежностей між опадами та фактичною продуктивністю.
   
2.  **Preprocessing:**
    * Очистка назв моделей техніки.
    * Обробка пропусків у погодних даних.
    * One-Hot Encoding для категоріальних ознак.

3.  **Моделювання:**
    * Використано **XGBoost Regressor**.
    * Ключова особливість: використання функції втрат `objective='reg:tweedie'`. Це дозволило коректніше прогнозувати цільову змінну, яка має розподіл з багатьма нулями і не може бути від'ємною (Tweedie distribution).

## Результати експериментів

Як основну метрику обрано **MAE (Mean Absolute Error)**, оскільки помилка в гектарах є найбільш зрозумілою для інтерпретації бізнесу.

| Модель | MAE (validation) | RMSE (validation) | Коментар |
| :--- | :--- | :--- | :--- |
| **XGBoost (Tweedie)** | **0.8** | **1.07** | **Найкращий результат. Стійка до викидів.** |
| CatBoost Regressor | 0.84 | 1.08 | Висока точність, але довше навчання. |
| Random Forest | 0.85 | 1.16 | Схильність до перенавчання на цьому датасеті. |
| Baseline (Mean) | 1.3 | 1.51 | Базовий рівень для порівняння. |


## Висновки

### Яка модель найкраща?
**XGBoost** з Tweedie loss показав найкращі результати.

### Практичні інсайти
1.  **Опади:** Більш важливими є накопичені опади за попередні періоди, аніж дощ зараз.
2.  **Фактор техніки:** Різниця в продуктивності між топовими моделями та старішими аналогами сягає 30-40% за однакових умов.

### Бізнес-використання
Модель опубліковано у вигляді веб-додатка на **[Streamlit](https://combine-harvest-prediction.streamlit.app/)**. На даному етапі для отримання прогнозу потрібно завантажити Excel-файл відповідної структури з запланованою технікою та погодними ознаками, а система побудує графік очікуваного виробітку на зміну. Приклад Excel-файла для тестування є у репозиторії під назвою "Приклад_для_завантаження_в_Streamlit.xlsx".

### Обмеження та покращення
* **Обмеження:** Модель не враховує раптові поломки техніки та людський фактор.
* **Кроки для подальшого покращення:**
    * Для покращення точності спробувати ансамбль моделей (спочатку класифікуємо чи зможе запланована техніка взагалі виїхати працювати враховуючи прогноз погоди, а тоді з якою продуктивністю).
    * Попрацювати з набором даних (додати інформацію про простої техніки з інших причин).
    * Розробити пайплайни для автоматичного отримання планів техніки, прогнозу погоди та розрахунку ознак
